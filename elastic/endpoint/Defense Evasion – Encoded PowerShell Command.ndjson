{"version":1,"type":"detection-rule","rule_id":"defense-evasion-encoded-powershell","name":"Defense Evasion - Encoded/Obfuscated PowerShell Command","description":"Detects obfuscated or encoded PowerShell execution using -EncodedCommand, -nop, -w hidden or base64-like arguments (MITRE T1059.001).","risk_score":65,"severity":"medium","author":["Wahid Hendrawan"],"tags":["MITRE:T1059.001","Defense Evasion","PowerShell"],"query":"(process.name:powershell.exe AND (process.args:*EncodedCommand* OR process.args:* -nop* OR process.args:* -w hidden*)) OR (process.name:powershell.exe AND process.args:*==*)","index":["logs-windows.sysmon-*","logs-endpoint.events.*"],"language":"kuery","type":"query","from":"now-15m","interval":"5m","enabled":true,"references":["https://attack.mitre.org/techniques/T1059/001/"],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1059.001","name":"PowerShell","reference":"https://attack.mitre.org/techniques/T1059/001/"}]}]}