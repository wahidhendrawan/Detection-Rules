{"version":1,"type":"detection-rule","rule_id":"defense-evasion-timestomp-suspect","name":"Defense Evasion - Suspicious File Timestamp Changes (Timestomping)","description":"Heuristic to flag potential timestomping: file modification activity where file metadata fields exist and show unusual patterns. NOTE: this detection requires file/audit logs that capture file timestamps (e.g., file.created, file.mtime, file.ctime). If your indices don't include these fields, disable or adapt this rule.","risk_score":70,"severity":"medium","author":["Wahid Hendrawan"],"tags":["MITRE:T1070","Defense Evasion","Timestomping"],"query":"(file.created:* AND file.mtime:*) AND (process.name:(powershell.exe OR cmd.exe OR explorer.exe OR rundll32.exe) OR event.action:(\"file_modified\" OR \"file_changed\" OR \"file_created\"))","index":["logs-windows.file-*","logs-windows.sysmon-*","logs-endpoint.events.*"],"language":"kuery","type":"query","from":"now-15m","interval":"5m","enabled":true,"references":["https://attack.mitre.org/techniques/T1070/"],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1070","name":"Indicator Removal on Host","reference":"https://attack.mitre.org/techniques/T1070/"}]}]}