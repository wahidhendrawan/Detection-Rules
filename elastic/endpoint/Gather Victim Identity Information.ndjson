{"version":1,"type":"detection-rule","rule_id":"recon-gather-victim-network-info","name":"Reconnaissance - Gather Victim Network Information (T1590)","description":"Detects attempts to gather victim network information via PowerShell or command line utilities. Attackers often enumerate network configurations and connectivity as part of reconnaissance.","risk_score":75,"severity":"medium","author":["Wahid Hendrawan"],"tags":["MITRE:T1590","Reconnaissance","Network Discovery","PowerShell","Command Prompt"],"query":"process.name:(powershell.exe OR cmd.exe) AND (process.args:(*ipconfig* OR *Get-NetAdapter* OR *Get-NetIPConfiguration* OR *netstat* OR *arp -a* OR *route print* OR *nslookup* OR *Resolve-DnsName*))","index":["logs-windows.sysmon-*","logs-endpoint.events.*"],"language":"kuery","type":"query","from":"now-15m","interval":"5m","enabled":true,"references":["https://attack.mitre.org/techniques/T1590/"],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0043","name":"Reconnaissance","reference":"https://attack.mitre.org/tactics/TA0043/"},"technique":[{"id":"T1590","name":"Gather Victim Network Information","reference":"https://attack.mitre.org/techniques/T1590/"}]}]}