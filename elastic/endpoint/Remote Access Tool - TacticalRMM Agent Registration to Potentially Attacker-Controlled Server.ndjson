{"name":"Remote Access Tool - TacticalRMM Agent Registration to Potentially Attacker-Controlled Server","tags":["attack.command-and-control","attack.t1105","attack.t1219"],"interval":"5m","enabled":true,"revision":0,"description":"Detects TacticalRMM agent installations where the --api, --auth, and related flags are used on the command line.\nThese parameters configure the agent to connect to a specific RMM server with authentication, client ID, and site ID.\nThis technique could indicate a threat actor attempting to register the agent with an attacker-controlled RMM infrastructure silently.\n","risk_score":21,"severity":"medium","license":"DRL 1.1","output_index":"","meta":{"from":"1m"},"author":["Ahmed Nosir (@egycondor)"],"false_positives":["Legitimate system administrator deploying TacticalRMM"],"from":"now-360s","rule_id":"2db93a3f-3249-4f73-9e68-0e77a0f8ae7e","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://github.com/amidaware/tacticalrmm","https://apophis133.medium.com/powershell-script-tactical-rmm-installation-45afb639eff3"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"esql","language":"esql","query":"FROM logs-* metadata _id, _version, _index | WHERE (process.executable.text rlike \".*\\\\\\\\[Tt][Aa][Cc][Tt][Ii][Cc][Aa][Ll][Aa][Gg][Ee][Nn][Tt]\\\\\\\\[Tt][Aa][Cc][Tt][Ii][Cc][Aa][Ll][Rr][Mm][Mm].[Ee][Xx][Ee].*\" and (process.command_line.text rlike \".*--[Aa][Pp][Ii].*\" and process.command_line.text rlike \".*--[Aa][Uu][Tt][Hh].*\" and process.command_line.text rlike \".*--[Cc][Ll][Ii][Ee][Nn][Tt]-[Ii][Dd].*\" and process.command_line.text rlike \".*--[Ss][Ii][Tt][Ee]-[Ii][Dd].*\" and process.command_line.text rlike \".*--[Aa][Gg][Ee][Nn][Tt]-[Tt][Yy][Pp][Ee].*\"))","actions":[]}